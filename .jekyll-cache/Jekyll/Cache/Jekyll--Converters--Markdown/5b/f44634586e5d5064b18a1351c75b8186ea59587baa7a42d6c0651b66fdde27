I"M<<h3 class="no_toc" id="êµ¬ì„±"><strong>êµ¬ì„±</strong></h3>
<details open="">
  <summary class="text-delta">í¼ì¹˜ê¸°/ì ‘ê¸°</summary>

<ol id="markdown-toc">
  <li><a href="#quiz3" id="markdown-toc-quiz3">ğŸ“<strong>Quiz3</strong></a></li>
</ol>

</details>
<hr />

<head>
<style>
    h5 {
        line-height : 165%; 
    }
</style>
</head>

<p><img src="/images/HC_writeup/quiz3/1.jpg" width="38%" height="38%" /></p>

<hr />

<h1 id="quiz3">ğŸ“<strong>Quiz3</strong></h1>
<p><img align="right" src="/images/HC_writeup/quiz3/2.jpg" width="43%" height="43%" style="border:2px solid black;" /></p>
<div style="margin-left:5%;margin-right:5%;">
<h5>ì‚¬ì‹¤ quiz3ëŠ” quiz1ê³¼ quiz2ë¥¼ í’€ì–´ì•¼ ë‚˜ì˜¤ëŠ” CTFë¬¸ì œì´ë‹¤. í•˜ì§€ë§Œ ì ì  í˜ì´ì§€ì— ëŒ€í•œ filteringì´ ì¶”ê°€ë˜ë©° ë‚œì´ë„ê°€ ì˜¬ë¼ê°€ëŠ” í˜•ì‹ì´ê¸° ë‚˜ëŠ” quiz3ë§Œ ë‹¤ë¤„ë³´ë ¤ í•œë‹¤ğŸ˜‰
ìš°ì„  ë¬¸ì œ í˜ì´ì§€ëŠ” ìš°ì¸¡ê³¼ ê°™ë‹¤ ê°„ëµí•˜ê²Œ ë¬¸ì œ ì„¤ëª…ì„ í•˜ìë©´ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•  ë•Œë§ˆë‹¤ ì„¸ì…˜ì„ ë¶€ì—¬ë°›ê³  ì´ëŠ” ë¬¸ì œì •ë³´, ì •ë‹µ, í˜„ì¬ ë‚´ ì ìˆ˜ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆë‹¤.
í˜ì´ì§€ ì†ŒìŠ¤ë¥¼ í™•ì¸í•´ë³´ë©´ ì´í•´ë  í…Œë‹ˆ í•œë²ˆ í™•ì¸í•´ ë³´ë„ë¡ í•˜ìğŸ˜—
</h5></div>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;h1&gt;</span>Quiz!<span class="nt">&lt;/h1&gt;</span>
		<span class="nt">&lt;p&gt;</span>your score : 0<span class="nt">&lt;/p&gt;</span>
		<span class="nt">&lt;hr&gt;</span>
		<span class="nt">&lt;h3&gt;</span>3534 * 5239 = ?<span class="nt">&lt;/h3&gt;</span>
		<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"#"</span> <span class="na">method=</span><span class="s">"GET"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"score"</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"number"</span> <span class="na">name=</span><span class="s">"answer"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;/form&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>
<div style="margin-left:5%;margin-right:5%;">
<h5>ì¶”ê°€ì ìœ¼ë¡œ ì´ë²ˆ ë¬¸ì œëŠ” quiz1,2 ì™€ëŠ” ë‹¤ë¥´ê²Œ ì„œë²„ ìì²´ì˜ ì†ŒìŠ¤ì½”ë“œë„ ë¬¸ì œ ìë£Œë¡œ ì œê³µ ë˜ì—ˆëŠ”ë° ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</h5></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">session</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">server</span><span class="p">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="s">"*****"</span>

<span class="n">FLAG</span> <span class="o">=</span> <span class="s">"HCAMP{*****}"</span> 

<span class="k">def</span> <span class="nf">check_flag_condition</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
        <span class="n">check_number</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">if</span> <span class="n">check_number</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># bye bye :)
</span>            <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="bp">False</span>

<span class="o">@</span><span class="n">server</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'index.html'</span><span class="p">)</span>

<span class="o">@</span><span class="n">server</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/quiz'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">quiz</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'score'</span><span class="p">)</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'answer'</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">user_answer</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'answer'</span><span class="p">))</span>
            <span class="n">score</span>       <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'score'</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">score</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">user_answer</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">score</span>       <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s">'answer'</span><span class="p">])</span> <span class="o">==</span> <span class="n">user_answer</span><span class="p">:</span>
            <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">+=</span> <span class="n">score</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># bye bye :)
</span>            <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">if</span> <span class="n">check_flag_condition</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">FLAG</span>

    <span class="c1"># quiz!
</span>    <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">session</span><span class="p">[</span><span class="s">'answer'</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'quiz.html'</span><span class="p">,</span>
            <span class="n">total_score</span><span class="o">=</span><span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">],</span>
            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
        

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">server</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'0.0.0.0'</span><span class="p">)</span>
</code></pre></div></div>

<div style="margin-left:5%;margin-right:5%;">
<h5>quiz 1,2 ì—ì„œëŠ” hiddeníƒ€ì…ì¸ input tagì˜ valueê°’ì„ ì¡°ì •í•˜ì—¬ scoreë¥¼ 100ì ì„ ë§Œë“¤ì–´ flagë¥¼ íšë“í•˜ëŠ” ë¬¸ì œì˜€ëŠ”ë° ì´ë²ˆ ë¬¸ì œì—ì„  ìœ„ì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ë³´ë©´ ì•Œê² ì§€ë§Œ <b>check_flag_condition</b>ì´ë¼ëŠ” í•¨ìˆ˜ê°€ socoreë¥¼ ê²€ì—´í•œë‹¤.. í•´ë‹¹ ë¶€ë¶„ë§Œ ì§§ê²Œ í•´ì„í•˜ìë©´ </h5></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_flag_condition</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
        <span class="n">check_number</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">if</span> <span class="n">check_number</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># bye bye :)
</span>            <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></div>
<div style="margin-left:5%;margin-right:5%;">
<h5> ìš°ì„  scoreê°€ 100ì ì´ ë„˜ì–´ê°€ë©´ Trueë¥¼ ë°˜í™˜í•œë‹¤(ëª©í‘œ!) í•˜ì§€ë§Œ! 50ê°œì˜ ë¬¸ì œë¥¼ í’€ê³  51ê°œì§¸ì˜ ë¬¸ì œë¥¼ í‘¸ëŠ” ì‹œì ë¶€í„°ëŠ” scoreê°’ì´ ì •ìˆ˜ í˜•íƒœì´ë©´ 0ìœ¼ë¡œ ì´ˆê¸°í™” ëœë‹¤...ğŸ˜« 
ì•„ë§ˆ ì—¬ê¸°ê¹Œì§€ ì½”ë“œë¥¼ í™•ì¸í•˜ë©´ ì´ëŸ° ìƒê°ì´ ë“¤ê±°ë‹¤ 'ê·¸ëŸ¼ ì†Œìˆ˜ì  3ìë¦¬ ì´ìƒì˜ ê°’ìœ¼ë¡œ ê°’ì„ ë„˜ê¸°ê±°ë‚˜ ì´ì „ ë¬¸ì œì™€ ë§ˆì°¬ê°€ì§€ë¡œ 100ì´ìƒì˜ valueê°’ì„ ë„˜ê²¨ì£¼ë©´ ë˜ëŠ”ê±° ì•„ë‹Œê°€?' 
</h5></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">quiz</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'score'</span><span class="p">)</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">session</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'answer'</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">user_answer</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'answer'</span><span class="p">))</span>
            <span class="n">score</span>       <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'score'</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">score</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">user_answer</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">score</span>       <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div>

<div style="margin-left:5%;margin-right:5%;">
<h5>í•˜ì§€ë§Œ ë‹¹ì—°í•˜ê²Œë„ ê·¸ ë¶€ë¶„ë„ ê²€ì—´í•œë‹¤ğŸ˜‚<b>quiz</b>ë¼ëŠ” í•¨ìˆ˜ì— ì˜í•´ input tagì˜ valueê°’ì„ 100ì´ìƒìœ¼ë¡œ ì¡°ì •í•´ requestí•˜ë”ë¼ë„ ì ìˆ˜ëŠ” 1ì ë§Œ ì˜¤ë¥¸ë‹¤
</h5></div>
:ET